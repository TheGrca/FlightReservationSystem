<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>All Reviews</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }

        table, th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }

        .edit-button {
            display: inline-block;
            padding: 5px 10px;
            background-color: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 4px;
        }

            .edit-button.disabled {
                background-color: #ccc;
                pointer-events: none;
            }
    </style>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1>All Reviews</h1>
    <table id="reviews-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Reviewer</th>
                <th>Airline</th>
                <th>Title</th>
                <th>Content</th>
                <th>Review Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="reviews-table-body">
            <!-- Reviews will be dynamically added here -->
        </tbody>
    </table>

    <script>
        $(document).ready(function () {
            function loadReviews() {
                $.ajax({
                    type: "GET",
                    url: "/api/reviews",
                    success: function (response) {
                        var reviewsTable = $("#reviews-table-body");
                        reviewsTable.empty();

                        response.forEach(function (review) {
                            var ReviewStatus;
                            if (review.ReviewStatus == "0") {
                                ReviewStatus = "Created"
                            } else if (review.ReviewStatus == "1") {
                                ReviewStatus = "Approved"
                            } else {
                                ReviewStatus = "Rejected"
                            }
                            reviewsTable.append(
                                `<tr>
                                        <td>${review.Id}</td>
                                        <td>${review.Reviewer.Name}</td>
                                        <td>${review.Airline.Name}</td>
                                        <td>${review.Title}</td>
                                        <td>${review.Content}</td>
                                        <td>${ReviewStatus}</td>
                                        <td>
                                            ${ReviewStatus === 'Created' ? `<a href="AdminEditReview.html?id=${review.Id}" class="edit-button">Edit</a>` : ''}
                                        </td>
                                    </tr>`
                            );
                        });
                    },
                    error: function (xhr, status, error) {
                        console.error('Error fetching reviews:', error);
                    }
                });
            }

            loadReviews();
        });
    </script>
</body>
</html>
